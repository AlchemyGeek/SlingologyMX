# SlingologyMX Functional Specification

**Version:** 1.0  
**Last Updated:** December 11, 2025

---

## 1. Overview

### 1.1 Purpose
SlingologyMX is a web-based maintenance tracking and compliance management system designed for experimental aircraft owners. The application enables users to track maintenance activities, manage regulatory compliance (Airworthiness Directives, Service Bulletins), monitor subscriptions, and receive timely notifications for upcoming maintenance requirements.

### 1.2 Target Users
- Experimental aircraft owners
- Aircraft builders maintaining their own aircraft
- A&P mechanics managing experimental aircraft maintenance

### 1.3 Technology Stack
- **Frontend:** React, TypeScript, Vite, Tailwind CSS
- **Backend:** Lovable Cloud (Supabase)
- **Database:** PostgreSQL
- **Authentication:** Supabase Auth with email verification

---

## 2. User Management

### 2.1 User Roles
| Role | Description |
|------|-------------|
| **Regular Member** | Default role for all users. Full access to personal maintenance records. |
| **Admin** | Full system access including user management and all user data. |

### 2.2 Membership Status
| Status | Description |
|--------|-------------|
| **Applied** | New user awaiting email verification |
| **Approved** | Active user with full access |
| **Suspended** | Access revoked by admin |

### 2.3 Authentication Flow
1. **Sign Up:**
   - User provides: Name (required), Email (required), Password, Location fields, Plane Registration (required), Plane Model/Make
   - Account created with status "Applied"
   - Verification email sent via Supabase Auth
   - Upon first login after verification, status changes to "Approved"

2. **Login:**
   - Email and password authentication
   - Suspended users cannot login
   - Password reset via email available

3. **Logout:**
   - Clears session and redirects to auth page

### 2.4 User Profile
Accessible from navigation. Users can view/edit:
- Name (max 50 characters)
- Email (read-only)
- Location (Country, State/Prefecture, City)
- Plane Registration (8 characters)
- Plane Model and Make (max 50 characters)

---

## 3. Aircraft Counters

### 3.1 Counter Types
| Counter | Description |
|---------|-------------|
| **Hobbs** | Hobbs meter time |
| **Tach** | Tachometer time |
| **Airframe Total Time** | Total airframe hours |
| **Engine Total Time** | Total engine hours |
| **Prop Total Time** | Total propeller hours |

### 3.2 Counter Management
- All counters initialize to 0
- Users can modify counters via dashboard UI (increment or set specific value)
- **Sync feature:** Non-Hobbs counters can be synchronized (toggle enabled by default)
- Displayed prominently on dashboard in large format

### 3.3 Counter History
- All changes logged with: date, counter values, source (Dashboard or Maintenance Record)
- Users can view complete history via History button
- **Revert capability:** Users can revert to any previous point, deleting subsequent history

### 3.4 Counter Sync with Maintenance Records
When creating/editing maintenance records:
- Counter fields auto-populate with current global values
- If entered value > current global value, user prompted to update global counter
- Changes logged with source "Maintenance Record"

---

## 4. Notifications System

### 4.1 Notification Types
| Type | Description |
|------|-------------|
| **Maintenance** | Maintenance-related reminders |
| **Subscription** | Subscription renewal reminders |
| **Directives** | Compliance-related notifications |
| **Other** | General notifications |

### 4.2 Notification Basis
| Basis | Description |
|-------|-------------|
| **Date-Based** | Triggered by calendar date |
| **Counter-Based** | Triggered by aircraft usage (counter values) |

### 4.3 Notification Fields
- **Description** (max 200 characters)
- **Type:** Maintenance, Subscription, Directives, Other
- **Component:** Airframe, Propeller, Avionics, Other
- **Initial Date/Counter Value**
- **Recurrence:** None, Weekly, Bi-Monthly, Monthly, Quarterly, Semi-Annual, Yearly
- **Notes** (max 1000 characters)
- **Alert Threshold:** Days (default 7) or Hours (default 10)

### 4.4 Notification Behavior
- **Completion:** Marking as complete sets completed_at timestamp
- **Recurring notifications:** Upon completion, new instance created with next due date/value
- **Non-recurring (None):** No new instance upon completion
- **Deletion:** Removes entire sequence, no new instances

### 4.5 Alert System
| State | Visual Indicator |
|-------|------------------|
| **Normal** | Primary blue |
| **Reminder** | Orange (within alert threshold) |
| **Due/Overdue** | Red |

### 4.6 Linked Notifications
- Notifications auto-generated by records (maintenance, directives, subscriptions) are linked
- **Link icon** displayed if linked AND not user-modified
- If user modifies: becomes detached, behaves like user-created
- If source record deleted/updated: linked notification follows (unless user-modified)

---

## 5. Subscriptions

### 5.1 Subscription Types
- EFB & Flight Planning
- Avionics Subscriptions
- Aircraft Maintenance, Tracking, & Record Services
- Proficiency & Safety Tools
- Aviation Community Memberships
- Weather Tools
- Magazine Subscription
- Aircraft Operations & Financial Tools
- Hardware-Related Annual Fees
- Insurance Related Add-Ons
- Other

### 5.2 Subscription Fields
- **Subscription Name** (required)
- **Type** (required)
- **Cost** (required)
- **Initial Date** (required)
- **Recurrence** (required)
- **Notes** (optional)

### 5.3 Subscription Behavior
- Only recurring subscriptions auto-generate renewal notification
- Notification retains subscription_id for cascading delete
- Subscription-linked notifications are fully editable/deletable by users

---

## 6. Maintenance Logs

### 6.1 Maintenance Categories
Airplane, Airframe, Engine, Propeller, Avionics, Electrical, Interior, Exterior, Accessories, Other

**Default:** Airplane

### 6.2 Maintenance Subcategories
Inspection, Repair, Replacement, Modification, Software Update, Compliance, Troubleshooting, Scheduled Maintenance, Other

### 6.3 Required Fields
- **Entry Title**
- **Category / Subcategory**
- **Date Performed**
- **Performed By Type:** Owner, A&P, LSRM, Repairman, Shop, Other
- **Performed By Name**
- **All Time & Usage fields:** Hobbs, Tach, Airframe TT, Engine TT, Prop TT

### 6.4 Optional Fields
- Tags
- Organization
- Vendor Name
- Invoice Number
- Cost fields (Parts, Labor, Other → auto-calculated Total)
- Internal Notes
- Attachment URLs (URL + optional Description)

### 6.5 Recurring Maintenance
Three recurrence mechanisms:
| Type | Description |
|------|-------------|
| **Interval (Date-Based)** | Monthly, Semi-Annual, Annual; next_due_date auto-calculates |
| **Counter (Usage-Based)** | Select counter type + increment value |
| **Mixed** | Both interval and counter; whichever occurs first |

- Auto-generates non-recurring notification with next due date/counter value
- Next Due Date can be manually overridden

### 6.6 Directive Linking
- Maintenance records can link to multiple directives via junction table
- Each linked directive gets a compliance status (Not Complied / Complied)
- When "Complied," compliance event auto-created in directive history
- Compliance date inherited from maintenance Date Performed

---

## 7. Directives & Bulletins

### 7.1 Directive Types
- FAA Airworthiness Directive
- Manufacturer Alert
- Manufacturer Mandatory
- Service Bulletin
- Service Instruction
- Information Bulletin
- Other

### 7.2 Directive Categories
Airframe, Engine, Propeller, Avionics, System, Appliance, Other

### 7.3 Directive Severity
Emergency, Mandatory, Recommended, Informational

### 7.4 Directive Status
Active (default), Superseded, Cancelled, Proposed, Completed

### 7.5 Compliance Scope
| Scope | Description |
|-------|-------------|
| **One-Time** | Single compliance action required |
| **Recurring** | Repeated compliance at intervals |
| **Conditional** | Compliance triggered by specific conditions |
| **Informational Only** | No action required |

### 7.6 Applicability Section
- **Category:** Airframe, Engine, Propeller, Avionics, Other
- **Model:** Text field for specific component
- **Applicable Serial Range**
- **Applies to My Aircraft:** Applies, Does Not Apply, Unsure
- **Reason/Explanation** (if applicable)
- **Applicability Notes**

### 7.7 Initial Due Type
| Type | Fields Shown | Notification Created |
|------|--------------|---------------------|
| **Before Next Flight** | None | Date-based, today |
| **At Next Inspection** | None | Date-based, today |
| **By Date** | Date picker | Date-based |
| **By Calendar (Months)** | Month selector + auto-calc date | Date-based |
| **By Total Time (Hours)** | Counter type + value | Counter-based |
| **Other** | None | None |

### 7.8 Recurring Directives
- For date-based: "Repeat Every (Months)" field
- For counter-based: "Repeat Every (Hours)" field
- Not available for "Other" type

### 7.9 Compliance Events
- **Managed exclusively through maintenance records**
- Directive detail view shows compliance events read-only
- Fields: Compliance Date (from maintenance), Status (Not Complied/Complied), Counter info (if applicable)

### 7.10 Auto-Completion Logic
When compliance event marked "Complied":
- **One-Time:** Directive auto-marked "Completed"
- **Recurring/Conditional:** User prompted to mark as "Completed"
- Linked non-user-modified notifications deleted
- For recurring: new notification created for next occurrence

### 7.11 Compliance Analysis Card
Displayed in directive detail view:
- First / Last Compliance Dates
- Counter Information (if counter-based)
- Total Compliance Events count
- Pending Notifications list

### 7.12 Constraints
- **Directive code unique per user**
- **Completed directives:** Cannot add/edit compliance events

---

## 8. Calendar View

### 8.1 Overview
Unified calendar displaying multiple record types with color coding.

### 8.2 Color Coding
| Record Type | Color |
|-------------|-------|
| Notifications | Primary Blue |
| Maintenance Logs | Secondary color |
| Directives | Purple |

### 8.3 Alert Status Colors
| Status | Color |
|--------|-------|
| Normal | Primary blue |
| Reminder | Orange |
| Due/Overdue | Red |

### 8.4 Display Rules
- **Date-based notifications only** (counter-based excluded)
- **Maintenance records:** Only actual date_performed (not projected next_due_date)
- **Directive history events** displayed
- Multiple record types on same date: diagonal gradient combines colors

### 8.5 Interaction
- Click date to view all records for that day
- Record details displayed with type-appropriate information

---

## 9. History Panel

### 9.1 Categories
| Tab | Records Shown |
|-----|---------------|
| **Notifications** | Completed notifications |
| **Maintenance** | All maintenance records |
| **Directives** | Directive history events (Create, Delete, Compliance) |

### 9.2 Features
- Text search
- Dropdown filters (type/category/action)
- Sortable columns with visual indicators
- Each tab has independent filtering/sorting

---

## 10. Data Management

### 10.1 Export Options
| Format | Description |
|--------|-------------|
| **JSON** | Machine-readable, suitable for import |
| **Excel** | Human-readable with separate worksheets per table |

### 10.2 Excel Export Features
- Separate worksheet per table
- Human-readable IDs: Prefix-YYMMDD-Counter (e.g., DIR-241125-001)
- All UUID references replaced with human-readable IDs
- Records sorted by creation date

### 10.3 Prefixes
| Table | Prefix |
|-------|--------|
| Directives | DIR |
| Subscriptions | SUB |
| Maintenance Logs | MNT |
| Notifications | NOT |
| Aircraft Counters | CNT |
| Aircraft Counter History | CNH |
| Aircraft Directive Status | ADS |
| Directive History | DHI |
| Maintenance Directive Compliance | MDC |

### 10.4 Import Features
- JSON format only
- Cross-user ID remapping (new UUIDs generated)
- Duplicate detection using business keys
- Import summary displayed after completion

### 10.5 Excluded from Export
- Bug reports
- Feature requests
- Profile information
- user_id fields (sanitized)

---

## 11. Bug Reporting

### 11.1 User-Submitted Fields
- **Title** (required)
- **Description** (required)
- **Actual Result** (required)
- Steps to Reproduce
- Expected Result
- Category (12 options)
- Severity: Minor, Moderate, Major, Critical
- Browser / OS / Device info
- Attachment URL

### 11.2 Admin-Only Fields
- **Status:** New, In Progress, Waiting for User, Resolved, Closed (Won't Fix), Closed (Duplicate)
- **Priority:** Low, Medium, High, Urgent
- Assigned To
- Root Cause
- Resolution Summary
- Internal Notes

### 11.3 Access Rules
- Users see only their own bug reports
- Admins see all bug reports
- Authentication required

---

## 12. Feature Requests

### 12.1 Fields
- **Title** (max 200 characters)
- **Description** (max 2000 characters)
- **Vote Count** (auto-calculated)
- **Status:** Open, Completed, Duplicate, Closed
- **Admin Comment** (max 50 characters, admin-only)

### 12.2 Voting
- One vote per user per feature
- Upvote / Downvote
- Sorted by vote count (highest first)

### 12.3 Tabs
| Tab | Content |
|-----|---------|
| **Open** | Open features (votable) |
| **Closed** | Completed/Duplicate/Closed features (read-only) |

### 12.4 Access Rules
- Authentication required
- Only admins can change status and add comments

---

## 13. Admin Capabilities

### 13.1 User Management
Accessible from Profile page (admin only):
- View all users with name, email, role, membership status
- View user record counts across all tables

### 13.2 User Operations
| Operation | Description |
|-----------|-------------|
| **Switch Role** | Toggle between Regular and Admin |
| **Set Password** | Generate auto-password (two-words + number + symbol) |
| **Suspend/Unsuspend** | Change membership status, force logout |
| **Wipe Database** | Delete all user records (except bug reports/feature requests) |
| **Delete User** | Anonymize contributions, delete account completely |

### 13.3 System Settings
- **Signup Control:** Toggle to enable/disable new user registrations

---

## 14. Navigation Structure

### 14.1 Header
- Profile link
- Logout button

### 14.2 Left Sidebar
```
Events
├── Calendar
├── Notifications
└── History

Records
├── Subscriptions
├── Maintenance
└── Directives & Bulletins

Support
├── Bug Reports
└── Feature Requests
```

### 14.3 Main Content Area
- Aircraft Counters display (top)
- Selected panel content

---

## 15. Date Handling

### 15.1 Input Methods
All date fields support:
1. Calendar picker
2. Direct text entry

### 15.2 Timezone Handling
- Date-only strings (YYYY-MM-DD) parsed as local dates
- parseLocalDate utility prevents timezone-related shifting

---

## 16. Security

### 16.1 Row-Level Security (RLS)
All tables protected by RLS policies:
- Users can only access their own records
- Admins can access all records

### 16.2 Authentication
- Server-side session validation
- Immediate session revocation on suspension
- Password hashing via Supabase Auth

### 16.3 Role Storage
- Roles stored in separate user_roles table
- Security definer function for role checks
- Prevents privilege escalation attacks

---

## 17. Database Schema

### 17.1 Core Tables
- profiles
- user_roles
- aircraft_counters
- aircraft_counter_history

### 17.2 Record Tables
- notifications
- subscriptions
- maintenance_logs
- directives

### 17.3 Supporting Tables
- aircraft_directive_status
- directive_history
- maintenance_directive_compliance
- bug_reports
- feature_requests
- feature_votes
- app_settings

---

## Appendix A: Recurrence Intervals

| Value | Period |
|-------|--------|
| Weekly | 7 days |
| Bi-Monthly | 2 months |
| Monthly | 1 month |
| Quarterly | 3 months |
| Semi-Annual | 6 months |
| Yearly | 12 months |
| None | Non-recurring |

---

## Appendix B: Bug Report Categories

1. Authentication
2. Notifications
3. Maintenance Logs
4. Directives
5. Subscriptions
6. Calendar
7. Counters
8. Profile
9. UI/Display
10. Performance
11. Data
12. Other
